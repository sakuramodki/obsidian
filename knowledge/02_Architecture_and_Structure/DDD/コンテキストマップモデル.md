---
level: 2
type: model
domain: DDD
tags: [domain-driven-design, bounded-context, strategic-design, integration, context-map]
---
# コンテキストマップモデル

本モデルは、ドメイン駆動設計（DDD）において、システムを構成する複数の[[境界づけられたコンテキストモデル]]間の関係性を視覚的に表現し、その連携パターンを定義するための「コンテキストマップ」を解説する。

## 1. 概要

コンテキストマップとは、システム全体の[[境界づけられたコンテキストモデル]]の配置と、それらの間の「契約」（連携方法）を俯瞰するための地図である。これにより、チーム間の技術的・組織的な関係性を明確にし、戦略的な設計判断を促進する。

## 2. 連携パターン

コンテキスト間の関係性は、チーム間の協力関係の度合いによって、大きく3つのカテゴリーに分類される。

### カテゴリー1: 緊密な協力 (Close Collaboration)

2つのチームが共通の目標を持ち、密接に連携する必要がある場合に選択されるパターン。

- **良きパートナー (Partnership)**
    - **定義**: 2つのチームが運命共同体となり、お互いの成功のために緊密に協力し、頻繁に同期を取りながら開発を進める。
    - **適用**: 両チームの成功が互いに強く依存している場合。

- **共有カーネル (Shared Kernel)**
    - **定義**: 複数のコンテキストで、ドメインモデルの一部（ソースコードやDBスキーマ）を共有する。共有部分は全チームの合意のもとで変更される。
    - **適用**: 複数のコンテキストで共通の基盤モデルが必要な場合。ただし、チーム間の調整コストが高いため、共有部分が安定的であることが望ましい。

### カテゴリー2: 利用者と供給者 (Customer/Supplier)

片方のチーム（上流/供給者）がサービスを提供し、もう片方（下流/利用者）がそれを利用する、非対称な関係性。

- **従属 (Conformist)**
    - **定義**: 下流チームが、上流チームのモデルを無条件に受け入れて利用する。下流側にはモデルに対する発言権がない。
    - **適用**: 上流チームが強い力を持つ場合や、上流モデルが下流のニーズに十分合致している場合。

- **腐敗防止層 (Anticorruption Layer - ACL)**
    - **定義**: 下流チームが、上流のモデルが自らのモデルを「汚染」するのを防ぐために、間に変換層（ACL）を設ける。ACLは、上流のモデルを下流のモデルに翻訳する役割を担う。
    - **適用**: 上流のモデルが複雑、頻繁に変更される、または下流の中核ドメインの概念と合わない場合。

- **公開ホストサービス (Open-Host Service - OHS) と 公開された言語 (Published Language - PL)**
    - **定義**: 上流チームが、外部の利用者のために安定した公開インターフェース（OHS）と、明確に定義された通信規約（PL）を提供する。内部モデルの変更が外部に影響を与えないようにする。
    - **適用**: 多くの下流チームにサービスを提供する場合。

### カテゴリー3: 互いに独立 (Separate Ways)

- **定義**: 2つのコンテキストが意図的に連携を避ける。同じような機能が必要な場合でも、統合のコストを嫌い、それぞれが独自に実装する。
- **適用**: 連携による価値が低い場合や、対象が一般的な業務領域で、それぞれが標準的な解決策を導入できる場合。

## 3. コンテキストマップの価値

- **全体像の可視化**: システム全体の構成と、コンポーネント間の依存関係を明確にする。
- **組織的な問題の発見**: マップ上の連携パターンと、実際のチーム間の関係性のズレから、組織的な課題を特定できる（例: 本来協力すべきチームが「互いに独立」になっている）。
- **戦略的な意思決定**: どの連携パターンを選択するかが、開発の進め方やチームの独立性に大きく影響するため、地図を元に議論することで、より良い設計を選択できる。

## 4. 関連リンク

- [[境界づけられたコンテキストモデル]]
