The content from the URL has been retrieved. It discusses "logical deletion" (論理削除) in the context of database design, particularly for user resources. It covers different approaches to handling deleted users, considering whether their treatment differs from active users.

Key points include:
*   **Resource Consideration**: How to model users (active vs. deleted) and whether their attributes or behaviors change upon deletion. It suggests using subtypes if their treatment differs.
*   **Event Consideration**: The importance of recording business events at the time of deletion, rather than just adding a `deleted_at` timestamp to the resource. It proposes event entities like "Registration Cancellation" or "BAN" to capture the context and attributes at the time of the event.
*   **Implementation of Resource Subtypes**: Discusses three common inheritance patterns for implementing resource subtypes in tables:
    *   **Single Table Inheritance**: All user types (active, deleted) in one table with a discriminator column. Pros: easy search across all users. Cons: performance issues with many deleted users, difficulty with unique constraints, and query complexity.
    *   **Concrete Table Inheritance**: Each subtype (active user, deleted user) in a separate table. Pros: natural handling of personal information for deleted users, no performance impact on active user searches. Cons: requires UNION for cross-type searches, difficulty with foreign key constraints.
    *   **Class Table Inheritance**: Common attributes in a parent table, specific attributes in child tables. Pros: easier cross-type searches, easier to add new subtypes. Cons: can be complex with O/R mappers.
*   **Relationship with Events**: How to handle foreign key relationships when users are logically deleted, especially for events like orders that reference users.
    *   **Referencing Latest Resource State**: If events always refer to the latest user state, a simple foreign key is sufficient.
    *   **Retaining Resource State at Event Time**: If events need to preserve the user's state at the time of the event, two methods are proposed:
        *   **Snapshot Method**: Copying user attributes into the event entity. Pros: complete historical user info, no impact from user deletion, simple. Cons: data duplication, large event entities.
        *   **Generation Management Method**: Using a "user generation" table to track changes over time. Pros: full change history, accurate historical user info, minimal data duplication. Cons: complex generation management, potential performance issues for cross-generation searches.

The article emphasizes that simply adding a `deleted_flag` or `deleted_at` to a resource entity is often a simplistic approach that overlooks the nuances of immutable data models and event-driven design. It encourages a deeper consideration of business events and resource subtypes.

Sources:
[1] 論理削除 - kawasima (https://scrapbox.io/kawasima/%E8%AB%93%E7%90%86%E5%89%8A%E9%99%A4)