---
tags: メソッド, SRE, モニタリング, アラート, 運用
---
# メソッド/効果的なモニタリングとアラート設計

# 概要
システムの健全性を把握し、問題発生時に迅速かつ適切に対応するために、何をどのように監視（モニタリング）し、どのような場合に警告（アラート）を発するべきかについての [[SRE(Site Reliability Engineering)]] におけるベストプラクティス。ノイズが多く対応されないアラートではなく、「緊急で人間による対応が必要な」状況のみを通知することを目指す。

# 前提となるモデル/理論とコンテキスト
* **モデル/理論**: [[モデル/SRE(Site Reliability Engineering)]], [[モデル/SLI_SLO_ErrorBudgetの原則]]
* **コンテキスト**: 本番システムの安定運用、障害の早期検知と対応が必要な状況。多数のメトリクスが存在し、何に注目すべきか、いつアラートを出すべきかの判断が難しい状況。

# 具体的な手順・考慮事項
1.  **モニタリングの4つのゴールデンシグナル**: Google SREが提唱する、特に注視すべき4種類のシグナル。
    * **レイテンシ (Latency)**: リクエスト処理にかかる時間（成功したリクエスト、失敗したリクエストの両方を区別）。
    * **トラフィック (Traffic)**: システムに対する負荷（例: HTTPリクエスト数/秒）。
    * **エラー (Errors)**: 失敗したリクエストの割合（明示的な失敗、暗黙的な失敗）。
    * **サチュレーション (Saturation)**: システムリソースの逼迫度（例: CPU使用率、メモリ使用量、ディスクI/O）。限界にどれだけ近いかを示す。
2.  **モニタリング対象の選択**: 上記ゴールデンシグナルを中心に、[[SLI(Service Level Indicator)]] として定義された指標や、システムのボトルネックとなりうる箇所を重点的に監視する。
3.  **モニタリングシステム**: 時系列データベース (TSDB) を用いたシステム（例: Prometheus, Borgmon）が一般的。ホワイトボックス（内部状態）とブラックボックス（外部からの挙動）の両方のモニタリングを組み合わせる。
4.  **アラート設計の原則**:
    * **緊急性**: 人間の即時対応が必要な場合にのみアラートを発する。
    * **アクション可能**: アラートを受け取った担当者が具体的な対応を取れるように、関連情報（プレイブックへのリンクなど）を含める。
    * **SLOベースのアラート**: 可能であれば、個々のエラーではなく、[[SLO(Service Level Objective)]] 違反や [[Error Budget]] の急激な消費に基づいてアラートを出す（例: Burn Rate アラート）。これにより短期的なスパイクによるノイズを減らす。
    * **ノイズの抑制**: 対応されないアラートは削除または調整する。アラート疲れを防ぐ。
5.  **ダッシュボード**: システム全体の健全性や主要なSLI/SLOの状況を一覧できるダッシュボードを用意する。アラート発生時の調査にも活用する。
6.  **継続的な改善**: アラートの閾値や監視項目は、システムの変更やインシデントの経験に基づいて継続的に見直す。
