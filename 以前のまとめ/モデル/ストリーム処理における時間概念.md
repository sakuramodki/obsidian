---
tags: モデル, ストリーム処理, 時間管理
aliases: Time Concepts in Stream Processing
---

# モデル: ストリーム処理における時間概念

## 概要
[[ストリーム処理(データ)]]において、「時間」は極めて重要な概念であり、イベントがいつ発生したか、いつ処理されたかによって結果が大きく変わる可能性があります。このモデルは、ストリーム処理で考慮すべき主要な時間の種類を分類します。

## どのような側面に着目し、どのような状態を捉えようとしているか
このモデルは、イベントデータに関連する「時刻」の様々な側面に着目します。イベントが現実世界で発生した本来の時刻と、それがシステムで処理される時刻との間に生じうる差異や、その差異をどのように扱って正確な結果を得るか、という状況を捉えようとしています。

## このモデル/理論が有効となるコンテキスト
* [[ストリーム処理(データ)]]、特に[[Boundedストリーム vs Unboundedストリーム]]のうちUnboundedストリームを扱う場合。
* イベントの発生順序が重要となる分析や処理 (例: 時系列分析、セッション分析)。
* ネットワーク遅延や処理の遅延が発生しうる分散環境でのストリーム処理。
* [[Flink_ウィンドウ処理]]など、時間に基づいてデータを区切る処理を行う場合。
* 結果の正確性や再現性が求められる場合 (イベント時間を使うことで決定論的な結果を得やすくなる)。

## このモデルの示す事
* **時間の種類 (主なもの):**
    * **Event Time (イベント時間):** イベントがその発生源で実際に生成された時刻。データ自体にタイムスタンプとして含まれることが多い。現実世界の出来事の順序に対応する。
    * **Processing Time (処理時間):** ストリーム処理システム（例: [[Apache_Flink]]のTaskManager）がイベントを処理するマシンのローカル時刻。最も実装が単純だが、遅延や順序の乱れの影響を受けやすく、非決定的になりやすい。
    * **Ingestion Time (到着時間):** イベントがストリーム処理システムのデータソース（入り口）に到着した時刻。イベント時間と処理時間の中間的な性質を持つ。
* **選択の重要性:** どの時間概念に基づいて処理を行うか（通常、処理エンジンで設定可能）が、処理結果の正確性、再現性、パフォーマンスに影響を与えることを示唆する。イベント時間処理は正確だが複雑さが増し、処理時間処理はシンプルだが不正確になる可能性がある。
* **課題:** イベント時間処理を行う場合、遅延したデータ（Late Events）や順序が乱れたデータ（Out-of-Order Events）をどう扱うかという課題が生じる。